{% load static %}
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Mis Pedidos | Zapatería Hnos. Rodríguez</title>

    <!-- ICONO -->
    <link rel="icon" type="image/png" href="{% static 'images/logo.ico' %}">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body { font-family: "Poppins", sans-serif; background-color: #f9f9f9; display: flex; flex-direction: column; min-height: 100vh; }

        /* Estilos específicos de la tabla de pedidos */
        .table thead { background-color: #222; color: white; }
        .pedido-card { transition: 0.2s; cursor: default; }
        .pedido-card:hover { background-color: #fff3cd !important; } /* Un ligero amarillo al pasar el ratón */
    </style>
</head>

<body>

    {% include 'sidebar.html' %}
    {% include 'sidebar_cart.html' %}
    {% include 'navbar.html' %}

    <div class="container my-5 flex-grow-1">
        <h2 class="text-center mb-5 fw-bold">Historial de Pedidos</h2>

        <div class="card shadow-sm border-0">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-striped align-middle mb-0">
                        <thead class="table-dark">
                            <tr>
                                <th scope="col" class="py-3 ps-4">Número</th>
                                <th scope="col" class="py-3">Estado</th>
                                <th scope="col" class="py-3">Subtotal</th>
                                <th scope="col" class="py-3">Fecha</th>
                                <th scope="col" class="py-3 text-end pe-4">Acciones</th>
                            </tr>
                        </thead>

                        <tbody>
                            {% for pedido in pedidos %}
                            <tr class="pedido-card">
                                <td class="ps-4 fw-bold">#{{ pedido.numero_pedido }}</td>
                                <td>
                                    <span class="badge rounded-pill
                                        {% if pedido.estado == 'PENDIENTE' %} bg-warning text-dark
                                        {% elif pedido.estado == 'PAGADO' %} bg-info text-dark
                                        {% elif pedido.estado == 'ENVIADO' %} bg-primary
                                        {% elif pedido.estado == 'COMPLETADO' %} bg-success
                                        {% elif pedido.estado == 'CANCELADO' %} bg-danger
                                        {% endif %}">
                                        {{ pedido.estado }}
                                    </span>
                                </td>
                                <td>{{ pedido.subtotal }} €</td>
                                <td>{{ pedido.fecha_creacion|date:"d/m/Y" }}</td>
                                <td class="text-end pe-4">
                                    <a class="btn btn-dark btn-sm" href="{% url 'detalle_pedido' pedido.id %}">
                                        Ver detalles <i class="fas fa-chevron-right ms-1"></i>
                                    </a>
                                </td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="5" class="text-center py-5">
                                    <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                                    <p class="text-muted">Aún no has realizado ningún pedido.</p>
                                    <a href="{% url 'product:product_list' %}" class="btn btn-warning">Ir a la tienda</a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    {% include 'footer.html' %}

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>